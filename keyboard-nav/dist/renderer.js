(()=>{"use strict";var e={600(e){e.exports=global.LensExtensions}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}var o={};(()=>{var e=o;Object.defineProperty(e,"__esModule",{value:!0});const t=n(600),r="keyboard-nav-styles",s="data-kbnav-selected",a=['.TableRow:not([class*="TableHead"])','[class*="TableRow"]:not([class*="TableHead"])'],i=['[class*="tableWrapper"]','[class*="TableWrapper"]','[class*="virtual-list"]','[class*="VirtualList"]','[class*="scrollable"]',".VirtualList"];function l(){const e=[];for(const t of a){const n=document.querySelectorAll(t);if(n.length>0){n.forEach(t=>{const n=t.tagName.toLowerCase();"thead"!==n&&"th"!==n&&null!==t.offsetParent&&(t.classList.toString().includes("Head")||e.includes(t)||e.push(t))});break}}return e}const c=new Map;function u(){return window.location.href}function d(e){const t=e.querySelector('[class*="TableCell"]')||e.firstElementChild;return((null==t?void 0:t.textContent)||e.textContent||"").trim().substring(0,100)}function f(){return document.querySelector(`[${s}="true"]`)}function h(){const e=f();e&&e.removeAttribute(s)}function p(e,t){t>=0&&t<e.length&&c.set(u(),{index:t,rowText:d(e[t])})}function v(e,t){if(h(),e.setAttribute(s,"true"),function(e){let t=null;for(const e of i)if(t=document.querySelector(e),t)break;if(!t){let n=e.parentElement;for(;n;){const e=getComputedStyle(n);if("auto"===e.overflow||"scroll"===e.overflow||"auto"===e.overflowY||"scroll"===e.overflowY){t=n;break}n=n.parentElement}}e.scrollIntoView({block:"nearest",behavior:"smooth"})}(e),t){const n=t.indexOf(e);-1!==n&&p(t,n)}}function b(e){const t=c.get(u());if(!t||0===e.length)return-1;const n=e.findIndex(e=>d(e)===t.rowText);if(-1!==n)return v(e[n],e),n;const o=Math.min(t.index,e.length-1);return v(e[o],e),o}class m extends t.Renderer.LensExtension{constructor(){super(...arguments),this.handleKeyDown=null,this.handleClick=null,this.mutationObserver=null,this.lastUrl=""}onActivate(){console.log("[KeyboardNav] Extension activated"),function(){if(document.getElementById(r))return;const e=document.createElement("style");e.id=r,e.textContent=`\n    [${s}="true"] {\n      outline: 2px solid #3d90ce !important;\n      outline-offset: -2px;\n      background: rgba(61, 144, 206, 0.15) !important;\n      position: relative;\n      z-index: 1;\n    }\n    [${s}="true"]::before {\n      content: "";\n      position: absolute;\n      left: 0;\n      top: 0;\n      bottom: 0;\n      width: 3px;\n      background: #3d90ce;\n      border-radius: 0 2px 2px 0;\n    }\n  `,document.head.appendChild(e)}(),this.setupClickListener(),this.setupKeyboardListener(),this.setupNavigationObserver()}onDeactivate(){console.log("[KeyboardNav] Extension deactivated"),this.teardownKeyboardListener(),this.teardownClickListener(),this.teardownNavigationObserver(),h(),function(){const e=document.getElementById(r);e&&e.remove()}()}setupClickListener(){this.handleClick=e=>{const t=e.target;if(!t)return;const n=function(e){let t=e;for(;t;){for(const e of a)if(t.matches(e))return t;t=t.parentElement}return null}(t);if(!n)return;const o=l(),r=o.indexOf(n);-1!==r&&(h(),n.setAttribute(s,"true"),p(o,r))},document.addEventListener("click",this.handleClick,!0)}teardownClickListener(){this.handleClick&&(document.removeEventListener("click",this.handleClick,!0),this.handleClick=null)}setupKeyboardListener(){this.handleKeyDown=e=>{var t,n;if(function(){const e=document.activeElement;if(!e)return!1;const t=e.tagName.toLowerCase();return"input"===t||"textarea"===t||"select"===t||"true"===e.contentEditable||!!e.closest('[role="dialog"]')}())return;const o=e.key,r=l();if(0===r.length)return;let s=f(),a=s?r.indexOf(s):-1;if(s&&-1===a&&(h(),s=null,a=-1),-1===a&&"Escape"!==o){const e=b(r);-1!==e&&(a=e,s=r[a])}switch(o){case"ArrowDown":case"j":e.preventDefault(),e.stopPropagation(),v(r[-1===a?0:Math.min(a+1,r.length-1)],r);break;case"ArrowUp":case"k":e.preventDefault(),e.stopPropagation(),v(r[-1===a?r.length-1:Math.max(a-1,0)],r);break;case"Enter":if(!s)return;e.preventDefault(),e.stopPropagation(),s.click();break;case"Escape":h(),document.activeElement&&(null===(n=(t=document.activeElement).blur)||void 0===n||n.call(t));break;case"Home":if(0===r.length)return;e.preventDefault(),e.stopPropagation(),v(r[0],r);break;case"End":if(0===r.length)return;e.preventDefault(),e.stopPropagation(),v(r[r.length-1],r);break;case"PageDown":e.preventDefault(),e.stopPropagation(),v(r[-1===a?0:Math.min(a+10,r.length-1)],r);break;case"PageUp":e.preventDefault(),e.stopPropagation(),v(r[-1===a?0:Math.max(a-10,0)],r);break;default:return}},document.addEventListener("keydown",this.handleKeyDown,!0)}teardownKeyboardListener(){this.handleKeyDown&&(document.removeEventListener("keydown",this.handleKeyDown,!0),this.handleKeyDown=null)}setupNavigationObserver(){this.lastUrl=window.location.href,this.mutationObserver=new MutationObserver(()=>{const e=window.location.href;if(e!==this.lastUrl){const t=f();if(t){const e=l(),n=e.indexOf(t);-1!==n&&p(e,n)}h(),this.lastUrl=e,setTimeout(()=>{const e=l();e.length>0&&!f()&&b(e)},300)}}),this.mutationObserver.observe(document.body,{childList:!0,subtree:!0})}teardownNavigationObserver(){this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null)}}e.default=m})(),module.exports=o})();